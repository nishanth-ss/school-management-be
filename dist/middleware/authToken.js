const a21_0x2ceb18=a21_0x15d3;(function(_0x29eac1,_0x2c7474){const _0x5cb927=a21_0x15d3,_0x12d0ff=_0x29eac1();while(!![]){try{const _0x1ff4b7=parseInt(_0x5cb927(0x1b5))/0x1+parseInt(_0x5cb927(0x1af))/0x2*(-parseInt(_0x5cb927(0x1b6))/0x3)+parseInt(_0x5cb927(0x1c1))/0x4+-parseInt(_0x5cb927(0x1bc))/0x5*(parseInt(_0x5cb927(0x19e))/0x6)+parseInt(_0x5cb927(0x1ac))/0x7*(-parseInt(_0x5cb927(0x1a9))/0x8)+parseInt(_0x5cb927(0x1c0))/0x9*(-parseInt(_0x5cb927(0x1c2))/0xa)+parseInt(_0x5cb927(0x1a7))/0xb*(parseInt(_0x5cb927(0x1a6))/0xc);if(_0x1ff4b7===_0x2c7474)break;else _0x12d0ff['push'](_0x12d0ff['shift']());}catch(_0x3e6e9f){_0x12d0ff['push'](_0x12d0ff['shift']());}}}(a21_0x28c9,0xd2b95));const jwt=require(a21_0x2ceb18(0x1ae)),tokenBlacklist=require(a21_0x2ceb18(0x1aa)),userModel=require(a21_0x2ceb18(0x1bb)),{default:axios}=require(a21_0x2ceb18(0x19d)),studentModel=require(a21_0x2ceb18(0x1a0)),JWT_SECRET=process[a21_0x2ceb18(0x1a1)][a21_0x2ceb18(0x1b9)],authenticateToken=(_0x44f57c,_0x5b37fd,_0x178827)=>{const _0x31357d=a21_0x2ceb18,_0x53d5fe=_0x44f57c['headers']['authorization'],_0x5031c2=_0x53d5fe&&_0x53d5fe['split']('\x20')[0x1];if(!_0x5031c2)return _0x5b37fd[_0x31357d(0x1be)](0x191)[_0x31357d(0x1c5)]({'message':_0x31357d(0x1a4)});if(tokenBlacklist[_0x31357d(0x1a5)](_0x5031c2))return _0x5b37fd[_0x31357d(0x1be)](0x191)[_0x31357d(0x1c5)]({'message':_0x31357d(0x1c3)});jwt[_0x31357d(0x1b8)](_0x5031c2,JWT_SECRET,async(_0x16af6b,_0x55adfc)=>{const _0x180d67=_0x31357d;if(_0x16af6b)return _0x5b37fd['status'](0x193)[_0x180d67(0x1c5)]({'message':_0x180d67(0x1c4)});const _0x1a0fcb=await userModel[_0x180d67(0x1b2)](_0x55adfc['id']);if(!_0x1a0fcb)return _0x5b37fd[_0x180d67(0x1be)](0x193)[_0x180d67(0x1ab)]({'success':![],'message':'please\x20check\x20your\x20credential\x20(may\x20be\x20user\x20deleted)'});if(_0x55adfc[_0x180d67(0x1b0)]===_0x180d67(0x1b4)){_0x1a0fcb[_0x180d67(0x1bf)]&&_0x1a0fcb[_0x180d67(0x1bf)]<new Date()&&(_0x1a0fcb['subscription']=![],await _0x1a0fcb['save']());const _0x424cb2=await studentModel[_0x180d67(0x19f)]({'user_id':_0x55adfc['id']});if(!_0x1a0fcb[_0x180d67(0x1b7)]){const _0x3dbad6=await axios[_0x180d67(0x1a8)](process[_0x180d67(0x1a1)][_0x180d67(0x1a3)]+_0x180d67(0x1ba),{'studentId':_0x424cb2[_0x180d67(0x1b3)]});return _0x5b37fd[_0x180d67(0x1be)](0x193)[_0x180d67(0x1c5)]({'success':![],'message':_0x180d67(0x1bd)});}}_0x44f57c[_0x180d67(0x1b1)]={'id':_0x55adfc['id'],'username':_0x55adfc[_0x180d67(0x1ad)],'role':_0x55adfc['role']},_0x178827();});};module[a21_0x2ceb18(0x1a2)]=authenticateToken;function a21_0x15d3(_0x5192b5,_0x50ffd1){_0x5192b5=_0x5192b5-0x19d;const _0x28c9c9=a21_0x28c9();let _0x15d39c=_0x28c9c9[_0x5192b5];return _0x15d39c;}function a21_0x28c9(){const _0x1ea8d7=['1473772PKJyob','7358140uRqhFd','Token\x20has\x20been\x20invalidated','Invalid\x20token','json','axios','1217040SrtxgA','findOne','../model/studentModel','env','exports','GLOBAL_URL','Access\x20token\x20required','has','12krXONW','31045982nzFqdV','put','632uCNluM','../utils/blackList','send','20699fuGwpX','username','jsonwebtoken','1285474DGjkTV','role','user','findById','_id','student','907194mdHFmN','3vkfEni','subscription','verify','JWT_SECRET','/api/payment/update','../model/userModel','40FEVUmG','Subscription\x20expired.\x20Please\x20renew.','status','subscriptionEnd','9msWbdc'];a21_0x28c9=function(){return _0x1ea8d7;};return a21_0x28c9();}