function a19_0x5b1d(_0x13e814,_0x46922d){_0x13e814=_0x13e814-0x82;const _0x27af95=a19_0x27af();let _0x5b1d46=_0x27af95[_0x13e814];return _0x5b1d46;}const a19_0x2d60bc=a19_0x5b1d;(function(_0x361318,_0x4dad67){const _0x1045ee=a19_0x5b1d,_0x1af2b4=_0x361318();while(!![]){try{const _0x2dc13a=parseInt(_0x1045ee(0x96))/0x1*(parseInt(_0x1045ee(0x9b))/0x2)+parseInt(_0x1045ee(0x90))/0x3+-parseInt(_0x1045ee(0x97))/0x4+parseInt(_0x1045ee(0xa2))/0x5*(parseInt(_0x1045ee(0xb6))/0x6)+-parseInt(_0x1045ee(0x9a))/0x7+parseInt(_0x1045ee(0xad))/0x8+parseInt(_0x1045ee(0x8d))/0x9*(-parseInt(_0x1045ee(0x88))/0xa);if(_0x2dc13a===_0x4dad67)break;else _0x1af2b4['push'](_0x1af2b4['shift']());}catch(_0x21cba4){_0x1af2b4['push'](_0x1af2b4['shift']());}}}(a19_0x27af,0x889f7));const TuckShopSchema=require(a19_0x2d60bc(0xb7)),UserSchema=require('../model/userModel'),mongoose=require(a19_0x2d60bc(0x83)),logAudit=require(a19_0x2d60bc(0xbb)),createTuckShop=async(_0xb6bbda,_0x1c61c6)=>{const _0x5eed6a=a19_0x2d60bc,_0x23baec=await UserSchema[_0x5eed6a(0x94)](_0xb6bbda['user']['id']);if(!_0x23baec[_0x5eed6a(0x92)])return _0x1c61c6[_0x5eed6a(0xb3)](0x194)[_0x5eed6a(0xaf)]({'success':![],'message':'please\x20add\x20location'});if(_0x23baec['role']===_0x5eed6a(0x89))try{const {itemName:_0x354ddc,description:_0x28fdd7,price:_0x181491,stockQuantity:_0x1a098e,itemNo:_0x54cebb,category:_0x45c040,status:_0x1ce5d6}=_0xb6bbda[_0x5eed6a(0x95)];if(_0x45c040==='recharge'&&_0x181491>0x1f4)return _0x1c61c6[_0x5eed6a(0xb3)](0x190)[_0x5eed6a(0xaf)]({'success':![],'message':_0x5eed6a(0x85)});if(!_0x354ddc||_0x181491==null||_0x1a098e==null||!_0x54cebb||!_0x45c040)return _0x1c61c6[_0x5eed6a(0xb3)](0x190)[_0x5eed6a(0x9f)]({'message':_0x5eed6a(0xb4)});const _0x554e64=await TuckShopSchema[_0x5eed6a(0xa6)]({'itemNo':_0x54cebb});if(_0x554e64)return _0x1c61c6[_0x5eed6a(0xb3)](0x193)[_0x5eed6a(0xaf)]({'success':![],'message':_0x5eed6a(0xb1)+_0x54cebb+_0x5eed6a(0x8e)});const _0x4c9d9a=await TuckShopSchema[_0x5eed6a(0xa6)]({'itemName':_0x354ddc,'price':_0x181491,'itemNo':_0x54cebb});if(_0x4c9d9a){_0x4c9d9a['stockQuantity']+=_0x1a098e;const _0xeae8e3=await _0x4c9d9a[_0x5eed6a(0x9e)]();return await logAudit({'userId':_0xb6bbda[_0x5eed6a(0x93)]['id'],'username':_0xb6bbda[_0x5eed6a(0x93)][_0x5eed6a(0xa0)],'action':'UPDATE_STOCK','targetModel':_0x5eed6a(0xbc),'targetId':_0xeae8e3[_0x5eed6a(0xb9)],'description':_0x5eed6a(0xa9)+_0xeae8e3['itemName']+'\x22.\x20New\x20quantity:\x20'+_0xeae8e3[_0x5eed6a(0xb2)],'changes':{'stockQuantity':_0xeae8e3['stockQuantity']}}),_0x1c61c6[_0x5eed6a(0xb3)](0xc8)['json']({'success':!![],'data':_0xeae8e3,'message':'Stock\x20updated\x20successfully'});}const _0x5c762c=new TuckShopSchema({'itemName':_0x354ddc,'description':_0x28fdd7,'price':_0x181491,'stockQuantity':_0x1a098e,'category':_0x45c040,'itemNo':_0x54cebb,'status':_0x1ce5d6}),_0x510522=await _0x5c762c[_0x5eed6a(0x9e)]();await logAudit({'userId':_0xb6bbda[_0x5eed6a(0x93)]['id'],'username':_0xb6bbda[_0x5eed6a(0x93)][_0x5eed6a(0xa0)],'action':_0x5eed6a(0x84),'targetModel':_0x5eed6a(0xbc),'targetId':_0x510522[_0x5eed6a(0xb9)],'description':_0x5eed6a(0xac)+_0x510522[_0x5eed6a(0x82)]+'\x22\x20in\x20category\x20\x22'+_0x510522['category']+'\x22','changes':{'itemName':_0x510522[_0x5eed6a(0x82)],'description':_0x510522[_0x5eed6a(0xa7)],'price':_0x510522[_0x5eed6a(0xa1)],'stockQuantity':_0x510522[_0x5eed6a(0xb2)],'category':_0x510522[_0x5eed6a(0x9c)]}}),_0x1c61c6[_0x5eed6a(0xb3)](0xc9)[_0x5eed6a(0x9f)]({'success':!![],'data':_0x510522,'message':_0x5eed6a(0xa4)});}catch(_0x47f60){_0x1c61c6[_0x5eed6a(0xb3)](0x1f4)['json']({'success':![],'message':_0x5eed6a(0x87),'error':_0x47f60[_0x5eed6a(0xb8)]});}else _0x1c61c6[_0x5eed6a(0xb3)](0x190)[_0x5eed6a(0x9f)]({'success':![],'message':'Admin\x20can\x20only\x20able\x20to\x20add\x20inventory'});},getAllTucks=async(_0x2e7073,_0x2d2d05)=>{const _0x26dc23=a19_0x2d60bc;try{const _0x36123d=await TuckShopSchema[_0x26dc23(0xa3)]()[_0x26dc23(0x8a)]({'createdAt':-0x1});if(!_0x36123d)return _0x2d2d05[_0x26dc23(0xb3)](0x194)[_0x26dc23(0x9f)]({'success':![],'message':_0x26dc23(0x9d)});_0x2d2d05['status'](0xc8)[_0x26dc23(0x9f)]({'success':!![],'data':_0x36123d});}catch(_0x1ab757){_0x2d2d05[_0x26dc23(0xb3)](0x1f4)[_0x26dc23(0x9f)]({'success':![],'message':_0x26dc23(0x87),'error':_0x1ab757[_0x26dc23(0xb8)]});}},getTuckShopItemById=async(_0xcdb998,_0x50c508)=>{const _0x50f104=a19_0x2d60bc;try{const {id:_0x2c6cf1}=_0xcdb998[_0x50f104(0x86)];if(!_0x2c6cf1)return _0x50c508[_0x50f104(0xb3)](0x190)[_0x50f104(0x9f)]({'message':_0x50f104(0xbd)});if(!mongoose['Types'][_0x50f104(0xa5)][_0x50f104(0xb0)](_0x2c6cf1))return _0x50c508[_0x50f104(0xb3)](0x190)['json']({'message':_0x50f104(0x8b)});const _0x1da8af=await TuckShopSchema[_0x50f104(0x94)](_0x2c6cf1);if(!_0x1da8af)return _0x50c508['status'](0x194)['json']({'message':_0x50f104(0xab)});_0x50c508[_0x50f104(0xb3)](0xc8)['json']({'success':!![],'data':_0x1da8af});}catch(_0x1c1e8b){_0x50c508[_0x50f104(0xb3)](0x1f4)[_0x50f104(0x9f)]({'success':![],'message':'Internal\x20server\x20error','error':_0x1c1e8b['message']});}},updateTuckShopItem=async(_0x29c0ab,_0x3621b6)=>{const _0x29c040=a19_0x2d60bc;try{const {id:_0xb84e47}=_0x29c0ab[_0x29c040(0x86)],_0x9f8781=_0x29c0ab['body'];if(_0x29c0ab[_0x29c040(0x95)][_0x29c040(0x9c)]===_0x29c040(0xbe)&&_0x29c0ab[_0x29c040(0x95)][_0x29c040(0xa1)]>0x1f4)return _0x3621b6[_0x29c040(0xb3)](0x190)[_0x29c040(0xaf)]({'success':![],'message':_0x29c040(0x85)});if(!_0xb84e47)return _0x3621b6[_0x29c040(0xb3)](0x190)[_0x29c040(0x9f)]({'message':'ID\x20is\x20missing'});if(!mongoose['Types'][_0x29c040(0xa5)][_0x29c040(0xb0)](_0xb84e47))return _0x3621b6[_0x29c040(0xb3)](0x190)[_0x29c040(0x9f)]({'message':_0x29c040(0x8b)});const _0x58c6db=await TuckShopSchema[_0x29c040(0xa8)](_0xb84e47,_0x9f8781,{'new':!![],'runValidators':!![]});if(!_0x58c6db)return _0x3621b6[_0x29c040(0xb3)](0x194)[_0x29c040(0x9f)]({'message':'No\x20item\x20found'});await logAudit({'userId':_0x29c0ab[_0x29c040(0x93)]['id'],'username':_0x29c0ab['user'][_0x29c040(0xa0)],'action':_0x29c040(0x99),'targetModel':_0x29c040(0xbc),'targetId':_0x58c6db[_0x29c040(0xb9)],'description':_0x29c040(0xb5)+_0x58c6db[_0x29c040(0x82)]+'\x22','changes':_0x9f8781}),_0x3621b6[_0x29c040(0xb3)](0xc8)[_0x29c040(0x9f)]({'success':!![],'data':_0x58c6db,'message':'TuckShop\x20item\x20updated\x20successfully'});}catch(_0x33b499){_0x3621b6[_0x29c040(0xb3)](0x1f4)[_0x29c040(0x9f)]({'success':![],'message':_0x29c040(0x87),'error':_0x33b499[_0x29c040(0xb8)]});}},deleteTuckShopItem=async(_0x188d60,_0x3e4bd5)=>{const _0x2d272d=a19_0x2d60bc;try{const {id:_0x4a3634}=_0x188d60[_0x2d272d(0x86)];if(!_0x4a3634)return _0x3e4bd5['status'](0x190)[_0x2d272d(0x9f)]({'message':_0x2d272d(0xbd)});if(!mongoose[_0x2d272d(0xba)][_0x2d272d(0xa5)][_0x2d272d(0xb0)](_0x4a3634))return _0x3e4bd5[_0x2d272d(0xb3)](0x190)['json']({'message':_0x2d272d(0x8b)});const _0x139d26=await TuckShopSchema['findByIdAndDelete'](_0x4a3634);if(!_0x139d26)return _0x3e4bd5['status'](0x194)['json']({'message':'No\x20item\x20found\x20to\x20delete'});await logAudit({'userId':_0x188d60['user']['id'],'username':_0x188d60[_0x2d272d(0x93)][_0x2d272d(0xa0)],'action':_0x2d272d(0xae),'targetModel':_0x2d272d(0xbc),'targetId':_0x139d26[_0x2d272d(0xb9)],'description':_0x2d272d(0x8f)+_0x139d26[_0x2d272d(0x82)]+'\x22','changes':_0x139d26}),_0x3e4bd5[_0x2d272d(0xb3)](0xc8)['json']({'success':!![],'message':_0x2d272d(0x98)});}catch(_0x12ecb3){_0x3e4bd5[_0x2d272d(0xb3)](0x1f4)[_0x2d272d(0x9f)]({'success':![],'message':_0x2d272d(0x87),'error':_0x12ecb3[_0x2d272d(0xb8)]});}},searchTuckItems=async(_0x100f18,_0x559aab)=>{const _0x4f4d61=a19_0x2d60bc;try{const {query:_0x43aa3b}=_0x100f18['query'];if(!_0x43aa3b||_0x43aa3b[_0x4f4d61(0xaa)]()==='')return _0x559aab[_0x4f4d61(0xb3)](0x190)[_0x4f4d61(0x9f)]({'message':_0x4f4d61(0x91)});const _0x287fdb=new RegExp(_0x43aa3b,'i'),_0x4d83ae=await TuckShopSchema[_0x4f4d61(0xa3)]({'$or':[{'itemName':_0x287fdb},{'category':_0x287fdb}]})[_0x4f4d61(0x8a)]({'createdAt':-0x1});_0x559aab[_0x4f4d61(0xb3)](0xc8)[_0x4f4d61(0x9f)]({'success':!![],'data':_0x4d83ae});}catch(_0x29640b){_0x559aab[_0x4f4d61(0xb3)](0x1f4)[_0x4f4d61(0x9f)]({'success':![],'message':_0x4f4d61(0x87),'error':_0x29640b['message']});}};module[a19_0x2d60bc(0x8c)]={'createTuckShop':createTuckShop,'getAllTucks':getAllTucks,'getTuckShopItemById':getTuckShopItemById,'updateTuckShopItem':updateTuckShopItem,'deleteTuckShopItem':deleteTuckShopItem,'searchTuckItems':searchTuckItems};function a19_0x27af(){const _0x3a4837=['Created\x20new\x20tuck\x20shop\x20item\x20\x22','1370488dvicVg','DELETE','send','isValid','item\x20number\x20','stockQuantity','status','Missing\x20required\x20fields','Updated\x20tuck\x20shop\x20item\x20\x22','6261342GCeMbj','../model/tuckShopModel','message','_id','Types','../utils/auditlogger','TuckShop','ID\x20is\x20missing','recharge','itemName','mongoose','CREATE','Recharge\x20failed:\x20the\x20amount\x20must\x20be\x20â‚¹500\x20or\x20less.','params','Internal\x20server\x20error','53450EjKqtd','ADMIN','sort','Invalid\x20ID\x20format','exports','1017bSWKZJ','\x20already\x20existing','Deleted\x20tuck\x20shop\x20item\x20\x22','2698281WSZLft','Search\x20query\x20is\x20required','location_id','user','findById','body','1LNDzFV','4371548OOrgBM','TuckShop\x20item\x20deleted\x20successfully','UPDATE','6053495gxSdBT','2013938PtaKLp','category','No\x20data\x20found','save','json','username','price','5YXlXjn','find','Item\x20created\x20successfully','ObjectId','findOne','description','findByIdAndUpdate','Updated\x20stock\x20for\x20item\x20\x22','trim','No\x20item\x20found'];a19_0x27af=function(){return _0x3a4837;};return a19_0x27af();}