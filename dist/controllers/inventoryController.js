const a13_0x5b0f49=a13_0x6d87;function a13_0x1bb4(){const _0x3493ce=['totalQty','updateOne','268587VBARfD','transferInventoryToCanteenInventory','68Wiamfo','create','findById','28104DIlkgM','findOne','\x20in\x20canteen\x20from\x20store','status','item\x20could\x20not\x20find','params','map','body','countDocuments','../model/tuckShopModel','../model/storeInventory','from-store','message','getInventoryStock','deleteOne','Item\x20','populate','createdAt','findOneAndUpdate','../model/vendorPurchase','Active','deleteCanteenItem','forEach','688088PtLWYR','internal\x20server\x20down','totalStock','skip','Vendor\x20and\x20items\x20updated\x20successfully;\x20tuck-shop\x20synced.','item\x20already\x20exists','itemName','Only\x20','Internal\x20server\x20error','transferIventoryProduct','141420JKUUld','reduce','desc','inventory\x20added\x20successfully','42kbNjqd','stockQuantity','Item\x20number\x20','push','set','General','inventory\x20stock\x20not\x20found','107438treQjv','Inventory\x20stock\x20not\x20found','No\x20data\x20found','toObject','json','toUpperCase','getCanteenItemListOptions','limit','all\x20fields\x20are\x20required','query','invoice\x20already\x20exists','$stock','90QePDTT','findByIdAndDelete','\x20in\x20canteen\x20successfully','inventory\x20stock\x20fetched\x20successfully','\x20already\x20exists\x20for\x20another\x20vendor\x20purchase.','1148441gBbhrY','findByIdAndUpdate','get','direct-set','these\x20item\x20number\x20already\x20exist\x20please\x20try\x20again','itemNo','exec','canteen\x20stock\x20created\x20successfully','../model/canteenInventory','stock','\x20deleted\x20successfully\x20from\x20canteen\x20and\x20store\x20inventory','length','toLowerCase','deleteInventoryItem','internal\x20server\x20dow','deleteMany','itemNo\x20and\x20transferQty\x20are\x20required','\x20set\x20to\x20','itemNo\x20is\x20required\x20to\x20delete\x20an\x20item','sort','bulkWrite','Inventory\x20stock\x20and\x20tuck-shop\x20item\x20deleted\x20successfully','find','_id','sellingPrice','category','Stock\x20of\x20','$category','1203UYnKUM','item\x20already\x20exists\x20in\x20tuckshop','entries','$itemNoUpper','asc','updateInventoryProduct1','No\x20stock\x20available\x20in\x20store\x20for\x20this\x20item','send','Vendor\x20and\x20items\x20updated,\x20tuck-shop\x20synced','Vendor\x20purchase\x20not\x20found','$itemNo','vendorPurchase','getAllCanteenItem1','amount','aggregate'];a13_0x1bb4=function(){return _0x3493ce;};return a13_0x1bb4();}function a13_0x6d87(_0x1157db,_0x195be9){_0x1157db=_0x1157db-0x174;const _0x1bb41e=a13_0x1bb4();let _0x6d8782=_0x1bb41e[_0x1157db];return _0x6d8782;}(function(_0x319845,_0x2d689d){const _0x15be74=a13_0x6d87,_0xeae269=_0x319845();while(!![]){try{const _0x38aeff=parseInt(_0x15be74(0x1a3))/0x1+parseInt(_0x15be74(0x174))/0x2*(-parseInt(_0x15be74(0x1d0))/0x3)+parseInt(_0x15be74(0x177))/0x4+-parseInt(_0x15be74(0x198))/0x5*(-parseInt(_0x15be74(0x19c))/0x6)+parseInt(_0x15be74(0x1b4))/0x7+-parseInt(_0x15be74(0x18e))/0x8+-parseInt(_0x15be74(0x1e1))/0x9*(parseInt(_0x15be74(0x1af))/0xa);if(_0x38aeff===_0x2d689d)break;else _0xeae269['push'](_0xeae269['shift']());}catch(_0x79021a){_0xeae269['push'](_0xeae269['shift']());}}}(a13_0x1bb4,0x1a6fb));const vendorPurchaseModel=require(a13_0x5b0f49(0x18a)),storeItemModel=require(a13_0x5b0f49(0x181)),tuckShopModel=require(a13_0x5b0f49(0x180)),CanteenInventory=require(a13_0x5b0f49(0x1bc)),{getVendorPurchaseSummary}=require('../service/storeInventoryService');exports['addInventoryStock']=async(_0xd0f7c2,_0x5a9588)=>{const _0x2c13f6=a13_0x5b0f49;try{const {date:_0x1020c2,invoiceNo:_0xbea0a4,vendorName:_0x4c835c,vendorValue:_0x40cca2,gatePassNumber:_0x63d197,contact:_0x5e576e,status:_0x4207e3,storeItems:_0x28cdfb}=_0xd0f7c2['body'];if(!_0x1020c2||!_0xbea0a4||!_0x4c835c||!_0x28cdfb||!_0x40cca2)return _0x5a9588['status'](0x190)[_0x2c13f6(0x1d7)]({'success':![],'message':_0x2c13f6(0x1ab)});const _0x30979e=await vendorPurchaseModel[_0x2c13f6(0x178)]({'invoiceNo':_0xbea0a4});if(_0x30979e)return _0x5a9588['status'](0x190)[_0x2c13f6(0x1d7)]({'success':![],'message':_0x2c13f6(0x1ad)});const _0x25f2fe=await vendorPurchaseModel['create']({'date':_0x1020c2,'invoiceNo':_0xbea0a4,'gatePassNumber':_0x63d197,'vendorName':_0x4c835c,'vendorValue':_0x40cca2,'contact':_0x5e576e,'status':_0x4207e3});let _0x3ae8d9;for(const _0x50c27b of _0x28cdfb){_0x3ae8d9=await storeItemModel['create']({'vendorPurchase':_0x25f2fe[_0x2c13f6(0x1cb)],'itemName':_0x50c27b[_0x2c13f6(0x194)],'itemNo':_0x50c27b[_0x2c13f6(0x1b9)],'amount':_0x50c27b[_0x2c13f6(0x1dd)],'stock':_0x50c27b['stock'],'sellingPrice':_0x50c27b[_0x2c13f6(0x1cc)],'category':_0x50c27b[_0x2c13f6(0x1cd)],'status':_0x50c27b[_0x2c13f6(0x17a)]});const _0x5236af=await tuckShopModel[_0x2c13f6(0x178)]({'itemNo':_0x50c27b['itemNo']});!_0x5236af&&await tuckShopModel['create']({'itemName':_0x50c27b['itemName'],'price':_0x50c27b[_0x2c13f6(0x1cc)],'stockQuantity':0x0,'category':_0x50c27b[_0x2c13f6(0x1cd)],'itemNo':_0x50c27b[_0x2c13f6(0x1b9)],'status':_0x50c27b[_0x2c13f6(0x17a)]});}return _0x5a9588[_0x2c13f6(0x1d7)]({'success':!![],'data':_0x3ae8d9,'message':_0x2c13f6(0x19b)});}catch(_0x3cf6fd){return _0x5a9588['status'](0x1f4)['send']({'success':![],'message':_0x2c13f6(0x18f),'error':_0x3cf6fd[_0x2c13f6(0x183)]});}},exports[a13_0x5b0f49(0x184)]=async(_0x1b58b9,_0x1befe8)=>{const _0xf5f238=a13_0x5b0f49;try{const _0x5d6628=await getVendorPurchaseSummary(_0x1b58b9[_0xf5f238(0x1ac)]);if(_0x5d6628[_0xf5f238(0x1bf)]===0x0)return _0x1befe8['status'](0xc8)['send']({'success':![],'data':_0x5d6628,'message':_0xf5f238(0x1a2)});return _0x1befe8['status'](0xc8)[_0xf5f238(0x1d7)]({'success':!![],'data':_0x5d6628,'message':_0xf5f238(0x1b2)});}catch(_0x17e2bf){return _0x1befe8[_0xf5f238(0x17a)](0x1f4)['send']({'success':![],'message':_0xf5f238(0x18f),'error':_0x17e2bf[_0xf5f238(0x183)]});}},exports['getInventoryStockById']=async(_0x546b89,_0x584312)=>{const _0x39f91f=a13_0x5b0f49;try{const {id:_0x43a5db}=_0x546b89[_0x39f91f(0x17c)],_0x1f4613=await storeItemModel['findById'](_0x43a5db)[_0x39f91f(0x187)](_0x39f91f(0x1db));if(!_0x1f4613)return _0x584312['status'](0x194)[_0x39f91f(0x1d7)]({'success':![],'message':_0x39f91f(0x1a2)});return _0x584312[_0x39f91f(0x1d7)]({'success':!![],'data':_0x1f4613,'message':_0x39f91f(0x1b2)});}catch(_0xc2c89a){return _0x584312[_0x39f91f(0x17a)](0x1f4)[_0x39f91f(0x1d7)]({'success':![],'message':_0x39f91f(0x18f),'error':_0xc2c89a[_0x39f91f(0x183)]});}},exports['updateInventoryProduct']=async(_0x1c0315,_0x10bcd2)=>{const _0xe9908b=a13_0x5b0f49;try{const {id:_0x3860e7}=_0x1c0315[_0xe9908b(0x17c)],{date:_0x202704,invoiceNo:_0x387196,vendorName:_0x5bf455,gatePassNumber:_0x450b21,vendorValue:_0x21e6f1,contact:_0x378907,status:_0x5329af,storeItems:storeItems=[]}=_0x1c0315['body'],_0x2174c6=await vendorPurchaseModel[_0xe9908b(0x176)](_0x3860e7);if(!_0x2174c6)return _0x10bcd2[_0xe9908b(0x17a)](0x194)['json']({'success':![],'message':_0xe9908b(0x1d9)});await vendorPurchaseModel[_0xe9908b(0x1b5)](_0x3860e7,{'date':_0x202704,'invoiceNo':_0x387196,'vendorName':_0x5bf455,'gatePassNumber':_0x450b21,'vendorValue':_0x21e6f1,'contact':_0x378907,'status':_0x5329af},{'new':!![]});for(const _0x34021d of storeItems){const {itemName:_0x3d59e4,itemNo:_0x398f84,amount:_0x4de5d9,stock:_0x3de7ef,sellingPrice:_0x4dab84,category:_0x5b88eb,status:_0x347d1e}=_0x34021d,_0x466294=await storeItemModel[_0xe9908b(0x178)]({'vendorPurchase':_0x3860e7,'itemNo':_0x398f84});if(_0x466294)await storeItemModel[_0xe9908b(0x1b5)](_0x466294[_0xe9908b(0x1cb)],{'amount':_0x4de5d9,'sellingPrice':_0x4dab84,'stock':_0x3de7ef}),await tuckShopModel[_0xe9908b(0x1e0)]({'itemNo':_0x398f84},{'$set':{'price':_0x4dab84}});else{const _0x8ebf88=await storeItemModel[_0xe9908b(0x178)]({'itemNo':_0x398f84});if(!_0x8ebf88[_0xe9908b(0x1bf)])return _0x10bcd2[_0xe9908b(0x17a)](0x190)[_0xe9908b(0x1d7)]({'success':![],'message':_0xe9908b(0x1b8)});await storeItemModel['create']({'vendorPurchase':_0x3860e7,'itemName':_0x3d59e4,'itemNo':_0x398f84,'amount':_0x4de5d9,'stock':_0x3de7ef,'sellingPrice':_0x4dab84,'category':_0x5b88eb,'status':_0x347d1e});}await tuckShopModel[_0xe9908b(0x189)]({'itemNo':_0x398f84},{'itemName':_0x3d59e4,'category':_0x5b88eb,'price':_0x4dab84,'status':_0x347d1e},{'upsert':!![],'new':!![]});}return _0x10bcd2[_0xe9908b(0x17a)](0xc8)[_0xe9908b(0x1a7)]({'success':!![],'message':_0xe9908b(0x1d8)});}catch(_0x5c4646){return _0x10bcd2['status'](0x1f4)[_0xe9908b(0x1a7)]({'success':![],'message':'Internal\x20server\x20error','error':_0x5c4646[_0xe9908b(0x183)]});}},exports[a13_0x5b0f49(0x197)]=async(_0x1895c2,_0x559c13)=>{const _0xa7d6f4=a13_0x5b0f49;try{const {itemNo:_0x2dfb22,transferQty:_0x40aace}=_0x1895c2[_0xa7d6f4(0x17e)],_0x5f3f95=await tuckShopModel['findOne']({'itemNo':_0x2dfb22});if(!itemData)return _0x559c13[_0xa7d6f4(0x17a)](0x194)[_0xa7d6f4(0x1d7)]({'success':![],'message':_0xa7d6f4(0x17b)});const _0x51e412=await storeItemModel[_0xa7d6f4(0x178)]({'itemNo':_0x2dfb22});}catch(_0x38e466){return _0x559c13[_0xa7d6f4(0x17a)](0x1f4)[_0xa7d6f4(0x1a7)]({'success':![],'message':'Internal\x20server\x20error','error':_0x38e466[_0xa7d6f4(0x183)]});}},exports[a13_0x5b0f49(0x1d5)]=async(_0xc14075,_0x51fe93)=>{const _0x9d09f=a13_0x5b0f49;try{const {id:_0x1baada}=_0xc14075[_0x9d09f(0x17c)],{date:_0x1f9c66,invoiceNo:_0x2661cc,vendorName:_0x276fc4,gatePassNumber:_0x5eada2,vendorValue:_0x4ee7b8,contact:_0x25c00e,status:_0x58afa8,storeItems:storeItems=[]}=_0xc14075[_0x9d09f(0x17e)],_0x52fd24=await vendorPurchaseModel[_0x9d09f(0x176)](_0x1baada);if(!_0x52fd24)return _0x51fe93['status'](0x194)[_0x9d09f(0x1a7)]({'success':![],'message':_0x9d09f(0x1d9)});await vendorPurchaseModel[_0x9d09f(0x1b5)](_0x1baada,{'date':_0x1f9c66,'invoiceNo':_0x2661cc,'gatePassNumber':_0x5eada2,'vendorName':_0x276fc4,'vendorValue':_0x4ee7b8,'contact':_0x25c00e,'status':_0x58afa8},{'new':!![]});const _0x11af2f=[];for(const [_0x5927b3,_0x243ccd]of storeItems[_0x9d09f(0x1d2)]()){const {itemNo:_0x20a3ab,itemName:_0xd02074,amount:_0x4ad0f2,stock:_0xbf7728,sellingPrice:_0x5560e3,category:_0x52ea04,status:_0x2ba7eb}=_0x243ccd;if(!_0x20a3ab||!_0xd02074){_0x11af2f[_0x9d09f(0x19f)]({'itemIndex':_0x5927b3,'message':'itemNo\x20and\x20itemName\x20are\x20required.'});continue;}const _0x44d650=await storeItemModel[_0x9d09f(0x178)]({'itemNo':_0x20a3ab,'vendorPurchase':{'$ne':_0x1baada}});_0x44d650&&_0x11af2f[_0x9d09f(0x19f)]({'itemNo':_0x20a3ab,'message':_0x9d09f(0x19e)+_0x20a3ab+_0x9d09f(0x1b3)});}if(_0x11af2f[_0x9d09f(0x1bf)]>0x0)return _0x51fe93[_0x9d09f(0x17a)](0x190)[_0x9d09f(0x1a7)]({'success':![],'message':'Validation\x20failed\x20for\x20one\x20or\x20more\x20items.','errors':_0x11af2f});for(const _0xbb6871 of storeItems){const {itemName:_0x4239f,itemNo:_0x296753,amount:_0x1a6f17,stock:_0x2c5c72,sellingPrice:_0x2cd6d9,category:_0x1ba4b0,status:_0x4af9b9}=_0xbb6871,_0x22f8d4=await storeItemModel[_0x9d09f(0x178)]({'vendorPurchase':_0x1baada,'itemNo':_0x296753});_0x22f8d4?await storeItemModel[_0x9d09f(0x1b5)](_0x22f8d4[_0x9d09f(0x1cb)],{'itemName':_0x4239f,'amount':_0x1a6f17,'stock':_0x2c5c72,'sellingPrice':_0x2cd6d9,'category':_0x1ba4b0,'status':_0x4af9b9}):await storeItemModel[_0x9d09f(0x175)]({'vendorPurchase':_0x1baada,'itemName':_0x4239f,'itemNo':_0x296753,'amount':_0x1a6f17,'stock':_0x2c5c72,'sellingPrice':_0x2cd6d9,'category':_0x1ba4b0,'status':_0x4af9b9}),await tuckShopModel['findOneAndUpdate']({'itemNo':_0x296753},{'itemName':_0x4239f,'category':_0x1ba4b0,'price':_0x2cd6d9,'status':_0x4af9b9},{'upsert':!![],'new':!![]});}return _0x51fe93[_0x9d09f(0x17a)](0xc8)[_0x9d09f(0x1a7)]({'success':!![],'message':_0x9d09f(0x192)});}catch(_0x2f6db1){return _0x51fe93[_0x9d09f(0x17a)](0x1f4)[_0x9d09f(0x1a7)]({'success':![],'message':_0x9d09f(0x196),'error':_0x2f6db1['message']});}},exports[a13_0x5b0f49(0x1e2)]=async(_0x37e66c,_0x5df0da)=>{const _0x4b01b0=a13_0x5b0f49;try{const {itemNo:_0x5895be,transferQty:_0x12fc3e,itemName:_0x104a85,price:_0x3c04e5,category:_0x248131,status:_0x40ef2f}=_0x37e66c['body'];if(!_0x5895be||!_0x12fc3e)return _0x5df0da[_0x4b01b0(0x17a)](0x190)[_0x4b01b0(0x1a7)]({'success':![],'message':_0x4b01b0(0x1c4)});if(_0x104a85&&_0x3c04e5&&_0x248131&&_0x40ef2f){const _0x5894a2=await tuckShopModel[_0x4b01b0(0x1e0)]({'itemNo':_0x5895be},{'$set':{'itemName':_0x104a85,'category':_0x248131,'price':_0x3c04e5,'status':_0x40ef2f,'description':'','stockQuantity':_0x12fc3e}},{'upsert':!![]});return await storeItemModel['updateMany']({'itemNo':_0x5895be},{'$set':{'itemName':_0x104a85,'category':_0x248131,'sellingPrice':_0x3c04e5}}),_0x5df0da['status'](0xc8)['json']({'success':!![],'mode':_0x4b01b0(0x1b7),'message':_0x4b01b0(0x1ce)+_0x104a85+'\x20set\x20to\x20'+_0x12fc3e+_0x4b01b0(0x1b1),'data':_0x5894a2});}const _0x4b2886=await storeItemModel[_0x4b01b0(0x1ca)]({'itemNo':_0x5895be,'stock':{'$gt':0x0}})[_0x4b01b0(0x1c7)]({'createdAt':-0x1});if(!_0x4b2886[_0x4b01b0(0x1bf)])return _0x5df0da[_0x4b01b0(0x17a)](0x190)[_0x4b01b0(0x1a7)]({'success':![],'message':_0x4b01b0(0x1d6)});const _0x4d5ccb=_0x4b2886[_0x4b01b0(0x199)]((_0x2556fc,_0x1464b9)=>_0x2556fc+_0x1464b9[_0x4b01b0(0x1bd)],0x0);if(_0x4d5ccb<_0x12fc3e)return _0x5df0da[_0x4b01b0(0x17a)](0x190)[_0x4b01b0(0x1a7)]({'success':![],'message':_0x4b01b0(0x195)+_0x4d5ccb+'\x20units\x20available,\x20cannot\x20transfer\x20'+_0x12fc3e});let _0x33bb5b=_0x12fc3e;const _0x83f380=[];for(const _0x2e923a of _0x4b2886){if(_0x33bb5b<=0x0)break;_0x2e923a[_0x4b01b0(0x1bd)]<=_0x33bb5b?(_0x83f380[_0x4b01b0(0x19f)]({'updateOne':{'filter':{'_id':_0x2e923a['_id']},'update':{'$set':{'stock':0x0}}}}),_0x33bb5b-=_0x2e923a[_0x4b01b0(0x1bd)]):(_0x83f380[_0x4b01b0(0x19f)]({'updateOne':{'filter':{'_id':_0x2e923a[_0x4b01b0(0x1cb)]},'update':{'$inc':{'stock':-_0x33bb5b}}}}),_0x33bb5b=0x0);}await storeItemModel[_0x4b01b0(0x1c8)](_0x83f380);const {itemName:_0x49cee2,category:_0x1d51cb,sellingPrice:_0x2b717f}=_0x4b2886[0x0],_0x158d24=await tuckShopModel[_0x4b01b0(0x178)]({'itemNo':_0x5895be}),_0x5c1c14=_0x158d24['stockQuantity']+_0x12fc3e;return await tuckShopModel['updateOne']({'itemNo':_0x5895be},{'$set':{'itemName':_0x49cee2,'category':_0x1d51cb||_0x4b01b0(0x1a1),'price':_0x2b717f,'status':_0x4b01b0(0x18b),'description':'','stockQuantity':_0x5c1c14}},{'upsert':!![]}),_0x5df0da[_0x4b01b0(0x17a)](0xc8)['json']({'success':!![],'mode':_0x4b01b0(0x182),'message':_0x4b01b0(0x1ce)+_0x49cee2+_0x4b01b0(0x1c5)+_0x12fc3e+_0x4b01b0(0x179)});}catch(_0x2a397d){return _0x5df0da[_0x4b01b0(0x17a)](0x1f4)[_0x4b01b0(0x1a7)]({'success':![],'message':_0x4b01b0(0x196),'error':_0x2a397d[_0x4b01b0(0x183)]});}},exports['deleteStoreData']=async(_0x3a5587,_0x5432de)=>{const _0x37c322=a13_0x5b0f49;try{const {id:_0x5cb9d6}=_0x3a5587[_0x37c322(0x17c)],_0x3fa3e3=await storeItemModel[_0x37c322(0x1b0)](_0x5cb9d6);if(!_0x3fa3e3)return _0x5432de['status'](0x194)['send']({'success':![],'message':_0x37c322(0x1a4)});return _0x5432de[_0x37c322(0x1d7)]({'success':!![],'data':_0x3fa3e3,'message':_0x37c322(0x1c9)});}catch(_0x3acd4e){return _0x5432de[_0x37c322(0x17a)](0x1f4)[_0x37c322(0x1d7)]({'success':![],'message':_0x37c322(0x196),'error':_0x3acd4e['message']});}},exports[a13_0x5b0f49(0x1c1)]=async(_0x3340b6,_0x3c374d)=>{const _0x17eea4=a13_0x5b0f49;try{const {id:_0x38ce33}=_0x3340b6['params'],_0x1e05af=await vendorPurchaseModel[_0x17eea4(0x176)](_0x38ce33);if(!_0x1e05af)return _0x3c374d[_0x17eea4(0x17a)](0x194)[_0x17eea4(0x1a7)]({'success':![],'message':_0x17eea4(0x1d9)});const _0x43ab08=await storeItemModel[_0x17eea4(0x1ca)]({'vendorPurchase':_0x38ce33});return await storeItemModel['deleteMany']({'vendorPurchase':_0x38ce33}),await vendorPurchaseModel[_0x17eea4(0x1b0)](_0x38ce33),_0x3c374d[_0x17eea4(0x17a)](0xc8)['json']({'success':!![],'message':'Vendor\x20purchase,\x20store\x20items,\x20and\x20tuck-shop\x20items\x20deleted\x20successfully'});}catch(_0x4d271e){return _0x3c374d[_0x17eea4(0x17a)](0x1f4)[_0x17eea4(0x1a7)]({'success':![],'message':_0x17eea4(0x196),'error':_0x4d271e['message']});}},exports[a13_0x5b0f49(0x1dc)]=async(_0xa778d8,_0x2b3809)=>{const _0x3c6809=a13_0x5b0f49;try{const {page:_0x14a740,limit:_0x1109ae,sortField:sortField='createdAt',sortOrder:sortOrder=_0x3c6809(0x19a),itemName:_0x4d9295,category:_0x19e184,status:_0x5072e2}=_0xa778d8[_0x3c6809(0x1ac)],_0xbc30cd={};if(_0x4d9295)_0xbc30cd[_0x3c6809(0x194)]={'$regex':_0x4d9295,'$options':'i'};if(_0x19e184)_0xbc30cd['category']={'$regex':'^'+_0x19e184+'$','$options':'i'};if(_0x5072e2)_0xbc30cd[_0x3c6809(0x17a)]=_0x5072e2;const _0x2abdc2=tuckShopModel[_0x3c6809(0x1ca)](_0xbc30cd),_0x27b92a={};_0x27b92a[sortField]=sortOrder[_0x3c6809(0x1c0)]()===_0x3c6809(0x1d4)?0x1:-0x1,_0x2abdc2[_0x3c6809(0x1c7)](_0x27b92a);let _0x2dffbf=![];if(_0x14a740&&_0x1109ae){const _0xa93eb8=(parseInt(_0x14a740)-0x1)*parseInt(_0x1109ae);_0x2abdc2[_0x3c6809(0x191)](_0xa93eb8)['limit'](parseInt(_0x1109ae)),_0x2dffbf=!![];}const _0x57a75d=await _0x2abdc2[_0x3c6809(0x1ba)]();if(!_0x57a75d[_0x3c6809(0x1bf)])return _0x2b3809['status'](0x194)[_0x3c6809(0x1a7)]({'success':![],'message':_0x3c6809(0x1a5)});const _0xbbc30a=_0x57a75d[_0x3c6809(0x17d)](_0x47f8ba=>_0x47f8ba[_0x3c6809(0x1b9)]),_0x5e4343=await storeItemModel[_0x3c6809(0x1de)]([{'$match':{'itemNo':{'$in':_0xbbc30a}}},{'$group':{'_id':{'itemName':'$itemName','itemNo':_0x3c6809(0x1da),'category':_0x3c6809(0x1cf)},'totalQty':{'$sum':_0x3c6809(0x1ae)}}}]),_0x3a5a3f=new Map();_0x5e4343['forEach'](_0x1f83ae=>{const _0x1d915d=_0x3c6809,_0x3c3ae7=_0x1f83ae['_id'][_0x1d915d(0x194)]+'|'+_0x1f83ae['_id'][_0x1d915d(0x1b9)]+'|'+_0x1f83ae[_0x1d915d(0x1cb)][_0x1d915d(0x1cd)];_0x3a5a3f[_0x1d915d(0x1a0)](_0x3c3ae7,_0x1f83ae[_0x1d915d(0x1df)]);});const _0x2e3035=_0x57a75d['map'](_0x10ea81=>{const _0x35073d=_0x3c6809,_0x2455e5=_0x10ea81[_0x35073d(0x194)]+'|'+_0x10ea81['itemNo']+'|'+_0x10ea81['category'];return{..._0x10ea81[_0x35073d(0x1a6)](),'totalQty':_0x3a5a3f[_0x35073d(0x1b6)](_0x2455e5)||0x0};});if(_0x2dffbf){const _0x2bdb72=await tuckShopModel['countDocuments'](_0xbc30cd);return _0x2b3809['status'](0xc8)[_0x3c6809(0x1a7)]({'success':!![],'page':parseInt(_0x14a740),'limit':parseInt(_0x1109ae),'totalCount':_0x2bdb72,'data':_0x2e3035});}return _0x2b3809[_0x3c6809(0x17a)](0xc8)[_0x3c6809(0x1a7)]({'success':!![],'data':_0x2e3035});}catch(_0x2b85ec){return _0x2b3809[_0x3c6809(0x17a)](0x1f4)[_0x3c6809(0x1a7)]({'success':![],'message':_0x3c6809(0x1c2),'error':_0x2b85ec});}},exports[a13_0x5b0f49(0x1dc)]=async(_0x18ff4e,_0x4804ab)=>{const _0x2c2dd7=a13_0x5b0f49;try{const {page:_0x342984,limit:_0x128cbb,sortField:sortField=_0x2c2dd7(0x188),sortOrder:sortOrder=_0x2c2dd7(0x19a),itemName:_0x2b6b1c,category:_0xd2bcd8,status:_0x147dc7}=_0x18ff4e['query'],_0x2e5fae={};if(_0x2b6b1c)_0x2e5fae[_0x2c2dd7(0x194)]={'$regex':_0x2b6b1c,'$options':'i'};if(_0xd2bcd8)_0x2e5fae[_0x2c2dd7(0x1cd)]={'$regex':'^'+_0xd2bcd8+'$','$options':'i'};if(_0x147dc7)_0x2e5fae[_0x2c2dd7(0x17a)]=_0x147dc7;const _0x5b47ed=tuckShopModel['find'](_0x2e5fae),_0x245c99={};_0x245c99[sortField]=sortOrder[_0x2c2dd7(0x1c0)]()===_0x2c2dd7(0x1d4)?0x1:-0x1,_0x5b47ed[_0x2c2dd7(0x1c7)](_0x245c99);let _0x22eaf4=![],_0x3f6dc0=0x1,_0x5ddb84=0x0;_0x342984&&_0x128cbb&&(_0x3f6dc0=parseInt(_0x342984)||0x1,_0x5ddb84=parseInt(_0x128cbb)||0xa,_0x5b47ed[_0x2c2dd7(0x191)]((_0x3f6dc0-0x1)*_0x5ddb84)['limit'](_0x5ddb84),_0x22eaf4=!![]);const _0x1646eb=await _0x5b47ed[_0x2c2dd7(0x1ba)]();if(!_0x1646eb[_0x2c2dd7(0x1bf)])return _0x4804ab[_0x2c2dd7(0x17a)](0xc8)[_0x2c2dd7(0x1a7)]({'success':!![],'message':_0x2c2dd7(0x1a5),'data':[]});const _0x1f6b67=_0x1646eb[_0x2c2dd7(0x17d)](_0x314779=>_0x314779[_0x2c2dd7(0x1b9)]),_0x51bcca=await storeItemModel[_0x2c2dd7(0x1de)]([{'$match':{'itemNo':{'$in':_0x1f6b67}}},{'$group':{'_id':_0x2c2dd7(0x1da),'totalStock':{'$sum':_0x2c2dd7(0x1ae)}}}]),_0x8ce118=new Map();_0x51bcca[_0x2c2dd7(0x18d)](_0x1d3bff=>_0x8ce118['set'](_0x1d3bff['_id'],_0x1d3bff[_0x2c2dd7(0x190)]));const _0x2f96c7=_0x1646eb[_0x2c2dd7(0x17d)](_0x84103c=>{const _0x54aa73=_0x2c2dd7,_0x5a72d5=Number(_0x84103c['stockQuantity'])||0x0,_0x17a00b=Number(_0x8ce118['get'](String(_0x84103c['itemNo'])))||0x0;return{..._0x84103c[_0x54aa73(0x1a6)](),'totalQty':_0x5a72d5+_0x17a00b};});if(_0x22eaf4){const _0x365801=await tuckShopModel[_0x2c2dd7(0x17f)](_0x2e5fae);return _0x4804ab[_0x2c2dd7(0x17a)](0xc8)['json']({'success':!![],'page':_0x3f6dc0,'limit':_0x5ddb84,'totalCount':_0x365801,'data':_0x2f96c7});}return _0x4804ab['status'](0xc8)[_0x2c2dd7(0x1a7)]({'success':!![],'data':_0x2f96c7});}catch(_0x25c35b){return _0x4804ab[_0x2c2dd7(0x17a)](0x1f4)['json']({'success':![],'message':_0x2c2dd7(0x196),'error':_0x25c35b['message']});}},exports['getAllCanteenItem']=async(_0x4f5b55,_0x13f379)=>{const _0x415936=a13_0x5b0f49;try{const {page:_0x5a2a82,limit:_0x3f1913,sortField:sortField=_0x415936(0x188),sortOrder:sortOrder=_0x415936(0x19a),itemName:_0x45af61,category:_0x11086f,status:_0x5b5045}=_0x4f5b55[_0x415936(0x1ac)],_0x47b9da={};if(_0x45af61)_0x47b9da[_0x415936(0x194)]={'$regex':_0x45af61,'$options':'i'};if(_0x11086f)_0x47b9da['category']={'$regex':'^'+_0x11086f+'$','$options':'i'};if(_0x5b5045)_0x47b9da[_0x415936(0x17a)]=_0x5b5045;const _0x57d467=tuckShopModel['find'](_0x47b9da),_0xe818a1={};_0xe818a1[sortField]=sortOrder[_0x415936(0x1c0)]()===_0x415936(0x1d4)?0x1:-0x1,_0x57d467['sort'](_0xe818a1);let _0x2d498e=![],_0x53b461=0x1,_0x444de9=0x0;_0x5a2a82&&_0x3f1913&&(_0x53b461=parseInt(_0x5a2a82)||0x1,_0x444de9=parseInt(_0x3f1913)||0xa,_0x57d467['skip']((_0x53b461-0x1)*_0x444de9)[_0x415936(0x1aa)](_0x444de9),_0x2d498e=!![]);const _0x3b0e95=await _0x57d467[_0x415936(0x1ba)]();if(!_0x3b0e95[_0x415936(0x1bf)])return _0x13f379['status'](0xc8)['json']({'success':!![],'message':'No\x20data\x20found','data':[]});const _0xff324a=_0x3b0e95['map'](_0x6e958f=>_0x6e958f['itemNo'][_0x415936(0x1a8)]()),_0x4ffad2=await storeItemModel[_0x415936(0x1de)]([{'$addFields':{'itemNoUpper':{'$toUpper':_0x415936(0x1da)}}},{'$match':{'itemNoUpper':{'$in':_0xff324a}}},{'$group':{'_id':_0x415936(0x1d3),'totalStock':{'$sum':'$stock'}}}]),_0x444e96=new Map();_0x4ffad2[_0x415936(0x18d)](_0x38dd26=>_0x444e96[_0x415936(0x1a0)](_0x38dd26[_0x415936(0x1cb)],_0x38dd26[_0x415936(0x190)]));const _0x53e758=_0x3b0e95[_0x415936(0x17d)](_0x353468=>{const _0x6bf993=_0x415936,_0x52f28e=Number(_0x353468[_0x6bf993(0x19d)])||0x0,_0x26962d=Number(_0x444e96[_0x6bf993(0x1b6)](_0x353468[_0x6bf993(0x1b9)][_0x6bf993(0x1a8)]()))||0x0;return{..._0x353468['toObject'](),'totalQty':_0x52f28e+_0x26962d};});if(_0x2d498e){const _0x27dcef=await tuckShopModel[_0x415936(0x17f)](_0x47b9da);return _0x13f379[_0x415936(0x17a)](0xc8)[_0x415936(0x1a7)]({'success':!![],'page':_0x53b461,'limit':_0x444de9,'totalCount':_0x27dcef,'data':_0x53e758});}return _0x13f379['status'](0xc8)[_0x415936(0x1a7)]({'success':!![],'data':_0x53e758});}catch(_0x4df7f9){return _0x13f379[_0x415936(0x17a)](0x1f4)[_0x415936(0x1a7)]({'success':![],'message':_0x415936(0x196),'error':_0x4df7f9['message']});}},exports[a13_0x5b0f49(0x18c)]=async(_0x27c1db,_0x3e01e3)=>{const _0x18bd4c=a13_0x5b0f49;try{const {id:_0xc4130a}=_0x27c1db[_0x18bd4c(0x17c)];if(!_0xc4130a)return _0x3e01e3[_0x18bd4c(0x17a)](0x190)[_0x18bd4c(0x1a7)]({'success':![],'message':_0x18bd4c(0x1c6)});const _0x43b79a=await tuckShopModel[_0x18bd4c(0x185)]({'itemNo':_0xc4130a}),_0x3492d1=await storeItemModel[_0x18bd4c(0x1c3)]({'itemNo':_0xc4130a});return _0x3e01e3['status'](0xc8)[_0x18bd4c(0x1a7)]({'success':!![],'message':_0x18bd4c(0x186)+_0xc4130a+_0x18bd4c(0x1be)});}catch(_0xe837c7){return _0x3e01e3[_0x18bd4c(0x17a)](0x1f4)[_0x18bd4c(0x1a7)]({'success':![],'message':'Internal\x20server\x20error','error':_0xe837c7[_0x18bd4c(0x183)]});}},exports[a13_0x5b0f49(0x1a9)]=async(_0x4d746e,_0x1461d4)=>{const _0x8061f9=a13_0x5b0f49;try{const {itemNo:_0x4c62ee}=_0x4d746e[_0x8061f9(0x1ac)],_0x4ba0ac={'status':'Active'};_0x4c62ee&&(_0x4ba0ac[_0x8061f9(0x1b9)]={'$regex':_0x4c62ee,'$options':'i'});const _0x3087cb=await tuckShopModel['find'](_0x4ba0ac);return _0x1461d4[_0x8061f9(0x17a)](0xc8)[_0x8061f9(0x1a7)]({'success':!![],'data':_0x3087cb});}catch(_0x2bbaa6){return _0x1461d4[_0x8061f9(0x17a)](0x1f4)[_0x8061f9(0x1a7)]({'success':![],'message':_0x8061f9(0x18f),'error':_0x2bbaa6});}},exports['createCanteenStock']=async(_0x155b66,_0x39f892)=>{const _0x4792c2=a13_0x5b0f49;try{const {itemName:_0x25f604,category:_0x2cf78d,itemNo:_0xd37fc6,stockQuantity:_0x59fa23,sellingPrice:_0x56d65e,status:_0x21120f}=_0x155b66[_0x4792c2(0x17e)],_0x356cf2=await storeItemModel[_0x4792c2(0x178)]({'itemNo':_0xd37fc6});if(_0x356cf2)return _0x39f892[_0x4792c2(0x17a)](0x194)['json']({'success':![],'message':_0x4792c2(0x193)});const _0x105c6f=await tuckShopModel[_0x4792c2(0x178)]({'itemNo':_0xd37fc6});if(_0x105c6f)return _0x39f892['status'](0x194)[_0x4792c2(0x1a7)]({'success':![],'message':_0x4792c2(0x1d1)});const _0x5d3c28=await storeItemModel[_0x4792c2(0x175)]({'itemName':_0x25f604,'category':_0x2cf78d,'itemNo':_0xd37fc6,'stock':0x0,'sellingPrice':_0x56d65e,'status':_0x21120f});return await tuckShopModel[_0x4792c2(0x175)]({'itemName':_0x25f604,'price':_0x56d65e,'stockQuantity':_0x59fa23,'category':_0x2cf78d,'itemNo':_0xd37fc6,'status':_0x21120f}),_0x39f892['status'](0xc8)[_0x4792c2(0x1a7)]({'success':!![],'message':_0x4792c2(0x1bb)});}catch(_0x20b5f1){return _0x39f892[_0x4792c2(0x17a)](0x1f4)[_0x4792c2(0x1a7)]({'success':![],'message':'internal\x20server\x20down','error':_0x20b5f1});}};