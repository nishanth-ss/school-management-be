const a0_0x2555bd=a0_0x56de;(function(_0x1e519b,_0x2a5788){const _0x3e47c2=a0_0x56de,_0x2329ef=_0x1e519b();while(!![]){try{const _0x3f35c1=-parseInt(_0x3e47c2(0x126))/0x1*(parseInt(_0x3e47c2(0x14c))/0x2)+-parseInt(_0x3e47c2(0x13f))/0x3*(-parseInt(_0x3e47c2(0x14e))/0x4)+-parseInt(_0x3e47c2(0x145))/0x5*(-parseInt(_0x3e47c2(0x13d))/0x6)+-parseInt(_0x3e47c2(0x12b))/0x7+parseInt(_0x3e47c2(0x12a))/0x8*(-parseInt(_0x3e47c2(0x14d))/0x9)+parseInt(_0x3e47c2(0x14f))/0xa+-parseInt(_0x3e47c2(0x137))/0xb;if(_0x3f35c1===_0x2a5788)break;else _0x2329ef['push'](_0x2329ef['shift']());}catch(_0x43c4cc){_0x2329ef['push'](_0x2329ef['shift']());}}}(a0_0x2e6a,0xeadad));const cron=require(a0_0x2555bd(0x14b)),fs=require('fs'),path=require('path'),{MongoClient}=require(a0_0x2555bd(0x13b)),backupLocationModel=require(a0_0x2555bd(0x13e));let currentJob=null;function a0_0x56de(_0x67ee72,_0x154c22){_0x67ee72=_0x67ee72-0x125;const _0x2e6a92=a0_0x2e6a();let _0x56de63=_0x2e6a92[_0x67ee72];return _0x56de63;}async function backupDatabase(){const _0x2d9d58=a0_0x2555bd;try{const _0x498fbb=await backupLocationModel['findOne']()[_0x2d9d58(0x134)]();let _0x20a17d=_0x498fbb?.['path'];if(!_0x20a17d)console[_0x2d9d58(0x127)](_0x2d9d58(0x144)),_0x20a17d=path['join'](__dirname,'..','..',_0x2d9d58(0x14a),_0x2d9d58(0x149));else try{fs[_0x2d9d58(0x125)](_0x20a17d,fs[_0x2d9d58(0x12e)][_0x2d9d58(0x129)]);}catch(_0x308ccd){console[_0x2d9d58(0x127)](_0x2d9d58(0x130)+_0x20a17d+_0x2d9d58(0x128)),_0x20a17d=path[_0x2d9d58(0x136)](__dirname,'..','..',_0x2d9d58(0x14a),_0x2d9d58(0x149));}const _0x170931=new Date()[_0x2d9d58(0x143)]()['replace'](/:/g,'-'),_0x490447=path['join'](_0x20a17d,_0x2d9d58(0x141)+_0x170931);fs[_0x2d9d58(0x140)](_0x490447,{'recursive':!![]});const _0x7b304f=new MongoClient(process['env'][_0x2d9d58(0x148)]);await _0x7b304f['connect']();const _0x5de963=_0x7b304f['db'](),_0x511add=await _0x5de963[_0x2d9d58(0x132)]()[_0x2d9d58(0x133)]();for(const {name:_0x22a4d2}of _0x511add){const _0x53ab84=await _0x5de963['collection'](_0x22a4d2)[_0x2d9d58(0x142)]()['toArray'](),_0x289453=path[_0x2d9d58(0x136)](_0x490447,_0x22a4d2+'.json');fs['writeFileSync'](_0x289453,JSON['stringify'](_0x53ab84,null,0x2)),console[_0x2d9d58(0x146)](_0x2d9d58(0x131)+_0x22a4d2);}console[_0x2d9d58(0x146)](_0x2d9d58(0x151)+_0x490447),await _0x7b304f[_0x2d9d58(0x12d)]();}catch(_0x5397b0){console['error']('âŒ\x20Backup\x20failed:',_0x5397b0['message']);}}async function scheduleBackup(){const _0xa36261=a0_0x2555bd,_0x4b3b41=await backupLocationModel[_0xa36261(0x12f)]()[_0xa36261(0x134)]();if(!_0x4b3b41||!_0x4b3b41[_0xa36261(0x135)]){console[_0xa36261(0x146)](_0xa36261(0x13c));return;}const _0x59f8f6=_0x4b3b41['cronTime'];console['log']('â±\x20Scheduling\x20backup\x20at\x20cron\x20time:\x20'+_0x59f8f6);if(currentJob)currentJob['destroy']();currentJob=cron[_0xa36261(0x13a)](_0x59f8f6,backupDatabase);}function a0_0x2e6a(){const _0x2c1caa=['backup-','find','toISOString','âš ï¸\x20No\x20backup\x20path\x20defined.\x20Using\x20default\x20folder\x20inside\x20server.','2616105mZNAHh','log','exports','DB_MONGO_URL','backup','public','node-cron','1541558mZXvCr','5658939PrUQan','16QdOYfd','16941870KPDiBH','ðŸ”„\x20Backup\x20schedule\x20changed\x20in\x20DB.\x20Rescheduling...','ðŸŽ‰\x20Backup\x20completed\x20successfully:\x20','accessSync','1pDYtEY','warn','\x22.\x20Using\x20default\x20folder\x20inside\x20server.','W_OK','8UGzpHw','5955369ODVyBd','message','close','constants','findOne','âš ï¸\x20Cannot\x20write\x20to\x20user-defined\x20path\x20\x22','âœ…\x20Saved\x20collection\x20','listCollections','toArray','lean','enabled','join','18418840wCKtES','error','Polling\x20error:','schedule','mongodb','âš ï¸\x20Backup\x20is\x20disabled\x20in\x20DB.','18qTZAau','../model/backupLocationModel','1217154fvehWr','mkdirSync'];a0_0x2e6a=function(){return _0x2c1caa;};return a0_0x2e6a();}async function rescheduleBackupOnUpdate(){let _0x3ccbde=null,_0x5a8d40=null;setInterval(async()=>{const _0x41d8a2=a0_0x56de;try{const _0x4655f0=await backupLocationModel[_0x41d8a2(0x12f)]()[_0x41d8a2(0x134)]();if(!_0x4655f0)return;const {cronTime:_0x1e2b1a,enabled:_0x5f2d9c}=_0x4655f0;(_0x1e2b1a!==_0x3ccbde||_0x5f2d9c!==_0x5a8d40)&&(_0x3ccbde=_0x1e2b1a,_0x5a8d40=_0x5f2d9c,console[_0x41d8a2(0x146)](_0x41d8a2(0x150)),await scheduleBackup());}catch(_0x1c288b){console[_0x41d8a2(0x138)](_0x41d8a2(0x139),_0x1c288b[_0x41d8a2(0x12c)]);}},0xea60);}module[a0_0x2555bd(0x147)]={'scheduleBackup':scheduleBackup,'rescheduleBackupOnUpdate':rescheduleBackupOnUpdate,'backupDatabase':backupDatabase};