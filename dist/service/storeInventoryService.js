const a66_0xbdc7b4=a66_0x296c;(function(_0x338f66,_0xe9af91){const _0x2e20c0=a66_0x296c,_0x3ec6e2=_0x338f66();while(!![]){try{const _0x430005=-parseInt(_0x2e20c0(0xd0))/0x1+-parseInt(_0x2e20c0(0xb7))/0x2*(-parseInt(_0x2e20c0(0xbc))/0x3)+parseInt(_0x2e20c0(0xce))/0x4*(-parseInt(_0x2e20c0(0xba))/0x5)+parseInt(_0x2e20c0(0xb6))/0x6+parseInt(_0x2e20c0(0xc8))/0x7+-parseInt(_0x2e20c0(0xcc))/0x8+-parseInt(_0x2e20c0(0xc0))/0x9*(-parseInt(_0x2e20c0(0xbb))/0xa);if(_0x430005===_0xe9af91)break;else _0x3ec6e2['push'](_0x3ec6e2['shift']());}catch(_0x34d7b1){_0x3ec6e2['push'](_0x3ec6e2['shift']());}}}(a66_0x4ea6,0xd836f));const mongoose=require(a66_0xbdc7b4(0xbe)),StoreItem=require(a66_0xbdc7b4(0xb3));function a66_0x4ea6(){const _0x4317dc=['2qwJtgK','vendorpurchases','aggregate','155VcUSbI','8489410Lkukuy','2270073XUtEWN','$vendorPurchase._id','mongoose','$stock','9CgIvIt','$createdAt','getVendorPurchaseSummary','$itemNo','$_id','$itemName','length','_id','9781793qDMevt','$gte','vendorPurchase.date','$lte','8955016SOTYvq','$vendorPurchase','53260RlyjxU','$category','819524BUqfoB','$updatedAt','$status','getVendorPurchaseSummary1','$amount','../model/storeInventory','vendorPurchase','$sellingPrice','1405500qGvkrq'];a66_0x4ea6=function(){return _0x4317dc;};return a66_0x4ea6();}function a66_0x296c(_0x304cfc,_0x5ec266){_0x304cfc=_0x304cfc-0xb0;const _0x4ea6cd=a66_0x4ea6();let _0x296c80=_0x4ea6cd[_0x304cfc];return _0x296c80;}exports[a66_0xbdc7b4(0xb1)]=async _0x21eedd=>{const _0x31f28e=a66_0xbdc7b4,{search:_0x186b64,startDate:_0x310c69,endDate:_0xce1f57,sortField:sortField=_0x31f28e(0xca),sortOrder:sortOrder=-0x1,page:page=0x1,limit:limit=0xa}=_0x21eedd,_0x181c1b=Number(page)||0x1,_0x30d71e=Number(limit)||0xa,_0x3c3f43={};if(_0x310c69)_0x3c3f43[_0x31f28e(0xc9)]=new Date(_0x310c69);if(_0xce1f57)_0x3c3f43[_0x31f28e(0xcb)]=new Date(_0xce1f57);const _0x4e5622=[{'$match':_0x186b64?{'itemName':{'$regex':_0x186b64,'$options':'i'}}:{}},{'$lookup':{'from':_0x31f28e(0xb8),'localField':_0x31f28e(0xb4),'foreignField':_0x31f28e(0xc7),'as':_0x31f28e(0xb4)}},{'$unwind':_0x31f28e(0xcd)},{'$match':{..._0x186b64&&{'$or':[{'vendorPurchase.invoiceNo':{'$regex':_0x186b64,'$options':'i'}},{'vendorPurchase.vendorName':{'$regex':_0x186b64,'$options':'i'}},{'itemName':{'$regex':_0x186b64,'$options':'i'}}]},...Object['keys'](_0x3c3f43)['length']&&{'vendorPurchase.date':_0x3c3f43}}},{'$group':{'_id':_0x31f28e(0xbd),'vendorPurchase':{'$first':_0x31f28e(0xcd)},'totalAmount':{'$sum':_0x31f28e(0xb2)},'items':{'$push':{'_id':'$_id','itemName':_0x31f28e(0xc5),'itemNo':_0x31f28e(0xc3),'amount':_0x31f28e(0xb2),'stock':_0x31f28e(0xbf),'sellingPrice':_0x31f28e(0xb5),'category':'$category','status':_0x31f28e(0xb0),'createdAt':_0x31f28e(0xc1),'updatedAt':_0x31f28e(0xd1)}}}},{'$project':{'_id':0x0,'vendorPurchase':0x1,'totalAmount':0x1,'items':0x1}},{'$sort':{[sortField]:sortOrder}},{'$skip':(_0x181c1b-0x1)*_0x30d71e},{'$limit':_0x30d71e}];return await StoreItem[_0x31f28e(0xb9)](_0x4e5622);},exports[a66_0xbdc7b4(0xc2)]=async _0x18c1f7=>{const _0x1ff731=a66_0xbdc7b4,{search:_0x46120f,startDate:_0x536966,endDate:_0x21ec7f,sortField:sortField=_0x1ff731(0xca),sortOrder:sortOrder=-0x1,page:page=0x1,limit:limit=0xa}=_0x18c1f7,_0x8eb5c2=Number(page)||0x1,_0x57b89d=Number(limit)||0xa,_0x577873={};if(_0x536966)_0x577873['$gte']=new Date(_0x536966);if(_0x21ec7f)_0x577873[_0x1ff731(0xcb)]=new Date(_0x21ec7f);const _0x40ad69=[{'$match':_0x46120f?{'itemName':{'$regex':_0x46120f,'$options':'i'}}:{}},{'$lookup':{'from':'vendorpurchases','localField':_0x1ff731(0xb4),'foreignField':_0x1ff731(0xc7),'as':_0x1ff731(0xb4)}},{'$unwind':_0x1ff731(0xcd)},{'$match':{..._0x46120f&&{'$or':[{'vendorPurchase.invoiceNo':{'$regex':_0x46120f,'$options':'i'}},{'vendorPurchase.vendorName':{'$regex':_0x46120f,'$options':'i'}},{'itemName':{'$regex':_0x46120f,'$options':'i'}}]},...Object['keys'](_0x577873)[_0x1ff731(0xc6)]&&{'vendorPurchase.date':_0x577873}}},{'$group':{'_id':_0x1ff731(0xbd),'vendorPurchase':{'$first':_0x1ff731(0xcd)},'totalAmount':{'$sum':'$amount'},'items':{'$push':{'_id':_0x1ff731(0xc4),'itemName':_0x1ff731(0xc5),'itemNo':'$itemNo','amount':'$amount','stock':_0x1ff731(0xbf),'sellingPrice':_0x1ff731(0xb5),'category':_0x1ff731(0xcf),'status':_0x1ff731(0xb0),'createdAt':'$createdAt','updatedAt':'$updatedAt'}}}},{'$project':{'_id':0x0,'vendorPurchase':0x1,'totalAmount':0x1,'items':0x1}},{'$sort':{[sortField]:sortOrder}},{'$skip':(_0x8eb5c2-0x1)*_0x57b89d},{'$limit':_0x57b89d}];return await StoreItem[_0x1ff731(0xb9)](_0x40ad69);};